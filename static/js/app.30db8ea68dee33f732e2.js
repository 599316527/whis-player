webpackJsonp([1],{NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("/5sW"),n=i("Gu7T"),o=i.n(n),r={name:"Whis",props:{src:[String,Array],volumeBoost:Boolean,trimSilence:Boolean,controls:Boolean,loop:Boolean,muted:Boolean,playbackRate:Number},data:function(){return{delayInterval:.1,sampleRate:44100,fftSize:Math.pow(2,10)}},computed:{realSrc:function(){return[].concat(this.src).map(function(e){return"string"==typeof e?{src:e,type:"audio/"+e.substring(e.lastIndexOf(".")+1)}:e})}},watch:{src:function(e){this.sourceNode=null},muted:function(e){this.$refs.audio.muted=e},controls:function(e){this.$refs.audio.controls=e},loop:function(e){this.$refs.audio.loop=e},playbackRate:function(e){this.$refs.audio.playbackRate=e},volumeBoost:function(e){this.updateAudioContext()},trimSilence:function(e){this.updateAudioContext()}},methods:{handleAudioPlay:function(){"suspended"===this.audioContext.state&&this.audioContext.resume()},handleAudioPlaying:function(){this.updateAudioContext()},handleAudioTimeUpdate:function(){var e=this;if(this.seekFlag)this.seekFlag=!1;else if(this.trimSilence){var t=this.$refs.audio.currentTime;this.analyserNode.getByteFrequencyData(this.analyserDataArray);var i=this.analyserDataArray.slice(this.freqRangeStartIndex,this.freqRangeEndIndex+1),a=Math.min.apply(Math,o()(i));i.map(function(e){return e-a}).every(function(e){return e<16})&&(this.seekFlag=!0,this.$nextTick(function(){e.$refs.audio.currentTime+=e.delayInterval,console.log("Skip: ",t,"+"+e.delayInterval)}))}},updateAudioContext:function(){this.sourceNode||(this.sourceNode=this.audioContext.createMediaElementSource(this.$refs.audio));for(var e=[this.sourceNode].concat(o()(this.audioMiddleNodes),[this.audioContext.destination]),t=0;t<e.length;t++)for(var i=0;i<e.length;i++)if(t!==i&&e[t].numberOfOutputs&&e[i].numberOfInputs)try{e[t].disconnect(e[i])}catch(e){}e=[this.sourceNode],this.trimSilence&&e.push(this.analyserNode),this.volumeBoost&&(e.push(this.warmthFilter),e.push(this.clarityFilter)),this.trimSilence&&e.push(this.delayNode),e.push(this.audioContext.destination);for(var a=0;a<e.length-1;a++)e[a].connect(e[a+1])},initAudioContext:function(){this.$refs.audio.playbackRate=this.playbackRate,this.audioContext=new AudioContext,this.delayNode=this.audioContext.createDelay(),this.delayNode.delayTime.value=this.delayInterval,this.warmthFilter=this.audioContext.createBiquadFilter(),this.warmthFilter.type="peaking",this.warmthFilter.frequency.value=400,this.warmthFilter.gain.value=4,this.warmthFilter.Q.value=2,this.clarityFilter=this.audioContext.createBiquadFilter(),this.clarityFilter.type="peaking",this.clarityFilter.frequency.value=2e3,this.clarityFilter.gain.value=12,this.clarityFilter.Q.value=2,this.analyserNode=this.audioContext.createAnalyser(),this.analyserNode.fftSize=this.fftSize,this.analyserNode.minDecibels=-90,this.analyserNode.maxDecibels=-30;var e=this.analyserNode.frequencyBinCount;this.analyserDataArray=new Uint8Array(e),this.freqRangeStartIndex=Math.ceil(110/(this.sampleRate/e)),this.freqRangeEndIndex=Math.floor(440/(this.sampleRate/e)),this.audioMiddleNodes=[this.analyserNode,this.warmthFilter,this.clarityFilter,this.delayNode]}},mounted:function(){this.seekFlag=!0,this.initAudioContext()}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("audio",e._b({ref:"audio",on:{play:e.handleAudioPlay,playing:e.handleAudioPlaying,timeupdate:e.handleAudioTimeUpdate}},"audio",{controls:e.controls,loop:e.loop,muted:e.muted},!1),e._l(e.realSrc,function(e){var t=e.src,a=e.type;return i("source",{key:t,attrs:{src:t,type:a}})}),0)},staticRenderFns:[]},l=i("VU/8")(r,s,!1,null,null,null).exports,u=i("fCto"),c=i.n(u),d={name:"App",components:{Whis:l},data:function(){return{src:c.a,volumeBoost:!1,playbackRate:1,trimSilence:!0,controls:!0,loop:!0,muted:!1}}},h={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("Whis",e._b({},"Whis",{src:e.src,controls:e.controls,loop:e.loop,muted:e.muted,volumeBoost:e.volumeBoost,playbackRate:e.playbackRate,trimSilence:e.trimSilence},!1)),e._v(" "),i("div",{staticClass:"control"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.volumeBoost,expression:"volumeBoost"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.volumeBoost)?e._i(e.volumeBoost,null)>-1:e.volumeBoost},on:{change:function(t){var i=e.volumeBoost,a=t.target,n=!!a.checked;if(Array.isArray(i)){var o=e._i(i,null);a.checked?o<0&&(e.volumeBoost=i.concat([null])):o>-1&&(e.volumeBoost=i.slice(0,o).concat(i.slice(o+1)))}else e.volumeBoost=n}}}),e._v("\n      Volume Boost\n    ")]),e._v(" "),i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.trimSilence,expression:"trimSilence"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.trimSilence)?e._i(e.trimSilence,null)>-1:e.trimSilence},on:{change:function(t){var i=e.trimSilence,a=t.target,n=!!a.checked;if(Array.isArray(i)){var o=e._i(i,null);a.checked?o<0&&(e.trimSilence=i.concat([null])):o>-1&&(e.trimSilence=i.slice(0,o).concat(i.slice(o+1)))}else e.trimSilence=n}}}),e._v("\n      Trim Silence\n    ")]),e._v(" "),i("label",[e._v("\n      Speed\n      "),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.playbackRate,expression:"playbackRate",modifiers:{number:!0}}],attrs:{type:"number",min:"0.8",step:"0.1",max:"5"},domProps:{value:e.playbackRate},on:{input:function(t){t.target.composing||(e.playbackRate=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})])])],1)},staticRenderFns:[]};var m=i("VU/8")(d,h,!1,function(e){i("f/J6")},null,null).exports;a.a.config.productionTip=!1,new a.a({el:"#app",render:function(e){return e(m)}})},"f/J6":function(e,t){},fCto:function(e,t,i){e.exports="static/media/sample.561b18a.mp3"}},["NHnr"]);
//# sourceMappingURL=app.30db8ea68dee33f732e2.js.map
